<!DOCTYPE html>
<html lang="en">
  {% include head.html %}
  <body>
    {% if page.id == 'home' %}
    <div id="loading">
      <img src="{{ site.baseurl }}/assets/load.png" alt="Loading..." />
    </div>
    <div id="content" style="display: none;">
    {% else %}
    <div id="content">
    {% endif %}
      <nav>{% include nav.html %}</nav>
      <div class="wrapper">
        <main>{{ content }}</main>
        <footer>{% include footer.html %}</footer>
      </div>
    </div>
    {% include link-previews.html wrapperQuerySelector="content" %}
    {% if page.id == 'home' %}
    <style>
      #loading {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #fff;
        z-index: 9999;
        opacity: 1;
        transition: opacity 1s ease-in-out;
      }
      #loading.fade-out {
        opacity: 0;
      }
      #content {
        opacity: 0;
        transition: opacity 1s ease-in-out;
      }
      #content.fade-in {
        opacity: 1;
      }
    </style>
    <script>
      window.addEventListener('load', function() {
        const loading = document.getElementById('loading');
        const content = document.getElementById('content');
        
        content.style.display = 'block';
        
        setTimeout(function() {
          loading.classList.add('fade-out');
          content.classList.add('fade-in');
          
          loading.addEventListener('transitionend', function() {
            loading.style.display = 'none';
          });
        }, 1000);
      });
    </script>
    {% endif %}
    <script>
    // Theme switcher
    const themeToggle = document.getElementById('theme-toggle');
    const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');

    // Function to set theme
    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
    }

    // Initialize theme
    const savedTheme = localStorage.getItem('theme') || (prefersDarkScheme.matches ? 'dark' : 'light');
    setTheme(savedTheme);

    // Toggle theme on button click
    themeToggle.addEventListener('click', () => {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      setTheme(newTheme);
    });

    // Listen for system theme changes
    prefersDarkScheme.addEventListener('change', (e) => {
      const newTheme = e.matches ? 'dark' : 'light';
      setTheme(newTheme);
    });
  </script>
  </body>
</html>
